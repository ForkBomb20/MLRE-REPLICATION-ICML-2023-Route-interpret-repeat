Getting T ready...
Inputs
data_root: ./data/CUB_200_2011
json_root: ./src/codebase/data_preprocessing
logs: ./log
checkpoints: ../../shared_data/group12/og_attr_checkpoints
checkpoint_file: best_model.pth.tar
checkpoint_file_t: best_model.pth.tar
output: ./out
attribute_file_name: og_attr_filtered.npy
seed: 0
pretrained: True
save_concepts: True
dataset: cub
img_size: 448
bs: 16
lr: 0.001
epochs: 95
solver_LR: sgd
loss_LR: BCE
epochs_LR: 50
layer: layer4
flattening_type: adaptive
arch: ResNet101
smoothing_value: 0.0
concept_names: ['has_bill_shape_dagger', 'has_bill_shape_hooked_seabird', 'has_bill_shape_allpurpose', 'has_bill_shape_cone', 'has_wing_color_brown', 'has_wing_color_grey', 'has_wing_color_yellow', 'has_wing_color_black', 'has_wing_color_white', 'has_wing_color_buff', 'has_upperparts_color_brown', 'has_upperparts_color_grey', 'has_upperparts_color_yellow', 'has_upperparts_color_black', 'has_upperparts_color_white', 'has_upperparts_color_buff', 'has_underparts_color_brown', 'has_underparts_color_grey', 'has_underparts_color_yellow', 'has_underparts_color_black', 'has_underparts_color_white', 'has_underparts_color_buff', 'has_breast_pattern_solid', 'has_breast_pattern_striped', 'has_breast_pattern_multicolored', 'has_back_color_brown', 'has_back_color_grey', 'has_back_color_yellow', 'has_back_color_black', 'has_back_color_white', 'has_back_color_buff', 'has_tail_shape_notched_tail', 'has_upper_tail_color_brown', 'has_upper_tail_color_grey', 'has_upper_tail_color_black', 'has_upper_tail_color_white', 'has_upper_tail_color_buff', 'has_head_pattern_plain', 'has_head_pattern_capped', 'has_breast_color_brown', 'has_breast_color_grey', 'has_breast_color_yellow', 'has_breast_color_black', 'has_breast_color_white', 'has_breast_color_buff', 'has_throat_color_grey', 'has_throat_color_yellow', 'has_throat_color_black', 'has_throat_color_white', 'has_eye_color_black', 'has_bill_length_about_the_same_as_head', 'has_bill_length_shorter_than_head', 'has_forehead_color_blue', 'has_forehead_color_brown', 'has_forehead_color_grey', 'has_forehead_color_yellow', 'has_forehead_color_black', 'has_forehead_color_white', 'has_forehead_color_red', 'has_under_tail_color_brown', 'has_under_tail_color_grey', 'has_under_tail_color_yellow', 'has_under_tail_color_black', 'has_under_tail_color_white', 'has_under_tail_color_buff', 'has_nape_color_blue', 'has_nape_color_brown', 'has_nape_color_grey', 'has_nape_color_yellow', 'has_nape_color_black', 'has_nape_color_white', 'has_nape_color_buff', 'has_belly_color_grey', 'has_belly_color_yellow', 'has_belly_color_black', 'has_belly_color_white', 'has_belly_color_buff', 'has_wing_shape_roundedwings', 'has_size_small_5__9_in', 'has_size_medium_9__16_in', 'has_size_very_small_3__5_in', 'has_shape_perchinglike', 'has_back_pattern_solid', 'has_back_pattern_striped', 'has_back_pattern_multicolored', 'has_tail_pattern_solid', 'has_tail_pattern_multicolored', 'has_belly_pattern_solid', 'has_primary_color_brown', 'has_primary_color_grey', 'has_primary_color_yellow', 'has_primary_color_black', 'has_primary_color_white', 'has_primary_color_buff', 'has_leg_color_grey', 'has_leg_color_black', 'has_leg_color_buff', 'has_bill_color_grey', 'has_bill_color_black', 'has_crown_color_blue', 'has_crown_color_brown', 'has_crown_color_grey', 'has_crown_color_yellow', 'has_crown_color_black', 'has_crown_color_white', 'has_wing_pattern_solid', 'has_wing_pattern_striped', 'has_wing_pattern_multicolored']
labels: ['Black_footed_Albatross', 'Laysan_Albatross', 'Sooty_Albatross', 'Groove_billed_Ani', 'Crested_Auklet', 'Least_Auklet', 'Parakeet_Auklet', 'Rhinoceros_Auklet', 'Brewer_Blackbird', 'Red_winged_Blackbird', 'Rusty_Blackbird', 'Yellow_headed_Blackbird', 'Bobolink', 'Indigo_Bunting', 'Lazuli_Bunting', 'Painted_Bunting', 'Cardinal', 'Spotted_Catbird', 'Gray_Catbird', 'Yellow_breasted_Chat', 'Eastern_Towhee', 'Chuck_will_Widow', 'Brandt_Cormorant', 'Red_faced_Cormorant', 'Pelagic_Cormorant', 'Bronzed_Cowbird', 'Shiny_Cowbird', 'Brown_Creeper', 'American_Crow', 'Fish_Crow', 'Black_billed_Cuckoo', 'Mangrove_Cuckoo', 'Yellow_billed_Cuckoo', 'Gray_crowned_Rosy_Finch', 'Purple_Finch', 'Northern_Flicker', 'Acadian_Flycatcher', 'Great_Crested_Flycatcher', 'Least_Flycatcher', 'Olive_sided_Flycatcher', 'Scissor_tailed_Flycatcher', 'Vermilion_Flycatcher', 'Yellow_bellied_Flycatcher', 'Frigatebird', 'Northern_Fulmar', 'Gadwall', 'American_Goldfinch', 'European_Goldfinch', 'Boat_tailed_Grackle', 'Eared_Grebe', 'Horned_Grebe', 'Pied_billed_Grebe', 'Western_Grebe', 'Blue_Grosbeak', 'Evening_Grosbeak', 'Pine_Grosbeak', 'Rose_breasted_Grosbeak', 'Pigeon_Guillemot', 'California_Gull', 'Glaucous_winged_Gull', 'Heermann_Gull', 'Herring_Gull', 'Ivory_Gull', 'Ring_billed_Gull', 'Slaty_backed_Gull', 'Western_Gull', 'Anna_Hummingbird', 'Ruby_throated_Hummingbird', 'Rufous_Hummingbird', 'Green_Violetear', 'Long_tailed_Jaeger', 'Pomarine_Jaeger', 'Blue_Jay', 'Florida_Jay', 'Green_Jay', 'Dark_eyed_Junco', 'Tropical_Kingbird', 'Gray_Kingbird', 'Belted_Kingfisher', 'Green_Kingfisher', 'Pied_Kingfisher', 'Ringed_Kingfisher', 'White_breasted_Kingfisher', 'Red_legged_Kittiwake', 'Horned_Lark', 'Pacific_Loon', 'Mallard', 'Western_Meadowlark', 'Hooded_Merganser', 'Red_breasted_Merganser', 'Mockingbird', 'Nighthawk', 'Clark_Nutcracker', 'White_breasted_Nuthatch', 'Baltimore_Oriole', 'Hooded_Oriole', 'Orchard_Oriole', 'Scott_Oriole', 'Ovenbird', 'Brown_Pelican', 'White_Pelican', 'Western_Wood_Pewee', 'Sayornis', 'American_Pipit', 'Whip_poor_Will', 'Horned_Puffin', 'Common_Raven', 'White_necked_Raven', 'American_Redstart', 'Geococcyx', 'Loggerhead_Shrike', 'Great_Grey_Shrike', 'Baird_Sparrow', 'Black_throated_Sparrow', 'Brewer_Sparrow', 'Chipping_Sparrow', 'Clay_colored_Sparrow', 'House_Sparrow', 'Field_Sparrow', 'Fox_Sparrow', 'Grasshopper_Sparrow', 'Harris_Sparrow', 'Henslow_Sparrow', 'Le_Conte_Sparrow', 'Lincoln_Sparrow', 'Nelson_Sharp_tailed_Sparrow', 'Savannah_Sparrow', 'Seaside_Sparrow', 'Song_Sparrow', 'Tree_Sparrow', 'Vesper_Sparrow', 'White_crowned_Sparrow', 'White_throated_Sparrow', 'Cape_Glossy_Starling', 'Bank_Swallow', 'Barn_Swallow', 'Cliff_Swallow', 'Tree_Swallow', 'Scarlet_Tanager', 'Summer_Tanager', 'Artic_Tern', 'Black_Tern', 'Caspian_Tern', 'Common_Tern', 'Elegant_Tern', 'Forsters_Tern', 'Least_Tern', 'Green_tailed_Towhee', 'Brown_Thrasher', 'Sage_Thrasher', 'Black_capped_Vireo', 'Blue_headed_Vireo', 'Philadelphia_Vireo', 'Red_eyed_Vireo', 'Warbling_Vireo', 'White_eyed_Vireo', 'Yellow_throated_Vireo', 'Bay_breasted_Warbler', 'Black_and_white_Warbler', 'Black_throated_Blue_Warbler', 'Blue_winged_Warbler', 'Canada_Warbler', 'Cape_May_Warbler', 'Cerulean_Warbler', 'Chestnut_sided_Warbler', 'Golden_winged_Warbler', 'Hooded_Warbler', 'Kentucky_Warbler', 'Magnolia_Warbler', 'Mourning_Warbler', 'Myrtle_Warbler', 'Nashville_Warbler', 'Orange_crowned_Warbler', 'Palm_Warbler', 'Pine_Warbler', 'Prairie_Warbler', 'Prothonotary_Warbler', 'Swainson_Warbler', 'Tennessee_Warbler', 'Wilson_Warbler', 'Worm_eating_Warbler', 'Yellow_Warbler', 'Northern_Waterthrush', 'Louisiana_Waterthrush', 'Bohemian_Waxwing', 'Cedar_Waxwing', 'American_Three_toed_Woodpecker', 'Pileated_Woodpecker', 'Red_bellied_Woodpecker', 'Red_cockaded_Woodpecker', 'Red_headed_Woodpecker', 'Downy_Woodpecker', 'Bewick_Wren', 'Cactus_Wren', 'Carolina_Wren', 'House_Wren', 'Marsh_Wren', 'Rock_Wren', 'Winter_Wren', 'Common_Yellowthroat']
spurious_specific_classes: n
spurious_waterbird_landbird: n
projected: n
bb_projected: _cov_1.0/iter1/bb_projected/batch_norm_n_finetune_y
root_explainer: _cov_1.0/iter1/t_projected/batch_norm_n_finetune_y
dataset_folder_concepts: lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE
./data/CUB_200_2011
#########################################
Paths
../../shared_data/group12/og_attr_checkpoints/cub/t/lr_0.001_epochs_95/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE
./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/stats
./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g
#########################################
Device: cuda
BB is loaded from ../../shared_data/group12/og_attr_checkpoints/cub/BB/lr_0.001_epochs_95/ResNet101/best_model.pth.tar
108
Attribute_file: og_attr_filtered.npy
Attribute_file: og_attr_filtered.npy
Length of the [train] dataset: 9422
(9422, 108)
Attribute_file: og_attr_filtered.npy
Length of the [val] dataset: 1183
(1183, 108)
Attribute_file: og_attr_filtered.npy
Length of the [test] dataset: 1183
(1183, 108)
Time to load train-test-val datasets: 359.8605270385742 secs
['has_bill_shape_dagger', 'has_bill_shape_hooked_seabird', 'has_bill_shape_allpurpose', 'has_bill_shape_cone', 'has_wing_color_brown', 'has_wing_color_grey', 'has_wing_color_yellow', 'has_wing_color_black', 'has_wing_color_white', 'has_wing_color_buff', 'has_upperparts_color_brown', 'has_upperparts_color_grey', 'has_upperparts_color_yellow', 'has_upperparts_color_black', 'has_upperparts_color_white', 'has_upperparts_color_buff', 'has_underparts_color_brown', 'has_underparts_color_grey', 'has_underparts_color_yellow', 'has_underparts_color_black', 'has_underparts_color_white', 'has_underparts_color_buff', 'has_breast_pattern_solid', 'has_breast_pattern_striped', 'has_breast_pattern_multicolored', 'has_back_color_brown', 'has_back_color_grey', 'has_back_color_yellow', 'has_back_color_black', 'has_back_color_white', 'has_back_color_buff', 'has_tail_shape_notched_tail', 'has_upper_tail_color_brown', 'has_upper_tail_color_grey', 'has_upper_tail_color_black', 'has_upper_tail_color_white', 'has_upper_tail_color_buff', 'has_head_pattern_plain', 'has_head_pattern_capped', 'has_breast_color_brown', 'has_breast_color_grey', 'has_breast_color_yellow', 'has_breast_color_black', 'has_breast_color_white', 'has_breast_color_buff', 'has_throat_color_grey', 'has_throat_color_yellow', 'has_throat_color_black', 'has_throat_color_white', 'has_eye_color_black', 'has_bill_length_about_the_same_as_head', 'has_bill_length_shorter_than_head', 'has_forehead_color_blue', 'has_forehead_color_brown', 'has_forehead_color_grey', 'has_forehead_color_yellow', 'has_forehead_color_black', 'has_forehead_color_white', 'has_forehead_color_red', 'has_under_tail_color_brown', 'has_under_tail_color_grey', 'has_under_tail_color_yellow', 'has_under_tail_color_black', 'has_under_tail_color_white', 'has_under_tail_color_buff', 'has_nape_color_blue', 'has_nape_color_brown', 'has_nape_color_grey', 'has_nape_color_yellow', 'has_nape_color_black', 'has_nape_color_white', 'has_nape_color_buff', 'has_belly_color_grey', 'has_belly_color_yellow', 'has_belly_color_black', 'has_belly_color_white', 'has_belly_color_buff', 'has_wing_shape_roundedwings', 'has_size_small_5__9_in', 'has_size_medium_9__16_in', 'has_size_very_small_3__5_in', 'has_shape_perchinglike', 'has_back_pattern_solid', 'has_back_pattern_striped', 'has_back_pattern_multicolored', 'has_tail_pattern_solid', 'has_tail_pattern_multicolored', 'has_belly_pattern_solid', 'has_primary_color_brown', 'has_primary_color_grey', 'has_primary_color_yellow', 'has_primary_color_black', 'has_primary_color_white', 'has_primary_color_buff', 'has_leg_color_grey', 'has_leg_color_black', 'has_leg_color_buff', 'has_bill_color_grey', 'has_bill_color_black', 'has_crown_color_blue', 'has_crown_color_brown', 'has_crown_color_grey', 'has_crown_color_yellow', 'has_crown_color_black', 'has_crown_color_white', 'has_wing_pattern_solid', 'has_wing_pattern_striped', 'has_wing_pattern_multicolored']
108
108
(1183, 108)
(1183, 108)
has_bill_shape_dagger: {'accuracy': 0.8796296296296297, 'precision': 0.375, 'recall': 0.2727272727272727, 'f1': 0.3157894736842105}
has_bill_shape_hooked_seabird: {'accuracy': 0.7407407407407407, 'precision': 1.0, 'recall': 0.2, 'f1': 0.3333333333333333}
has_bill_shape_allpurpose: {'accuracy': 0.7962962962962963, 'precision': 0.25, 'recall': 0.05, 'f1': 0.08333333333333333}
has_bill_shape_cone: {'accuracy': 0.9259259259259259, 'precision': 0.4166666666666667, 'recall': 0.8333333333333334, 'f1': 0.5555555555555556}
has_wing_color_brown: {'accuracy': 0.8518518518518519, 'precision': 0.875, 'recall': 0.3181818181818182, 'f1': 0.4666666666666667}
has_wing_color_grey: {'accuracy': 0.9074074074074074, 'precision': 1.0, 'recall': 0.5652173913043478, 'f1': 0.7222222222222222}
has_wing_color_yellow: {'accuracy': 0.8240740740740741, 'precision': 0.625, 'recall': 0.23809523809523808, 'f1': 0.3448275862068966}
has_wing_color_black: {'accuracy': 0.8240740740740741, 'precision': 0.8888888888888888, 'recall': 0.3076923076923077, 'f1': 0.45714285714285713}
has_wing_color_white: {'accuracy': 0.9537037037037037, 'precision': 0.9411764705882353, 'recall': 0.8, 'f1': 0.8648648648648649}
has_wing_color_buff: {'accuracy': 0.9351851851851852, 'precision': 0.9285714285714286, 'recall': 0.6842105263157895, 'f1': 0.7878787878787878}
has_upperparts_color_brown: {'accuracy': 0.8981481481481481, 'precision': 0.6666666666666666, 'recall': 0.625, 'f1': 0.6451612903225806}
has_upperparts_color_grey: {'accuracy': 0.8240740740740741, 'precision': 0.875, 'recall': 0.28, 'f1': 0.42424242424242425}
has_upperparts_color_yellow: {'accuracy': 0.8240740740740741, 'precision': 0.5, 'recall': 0.15789473684210525, 'f1': 0.24}
has_upperparts_color_black: {'accuracy': 0.8148148148148148, 'precision': 0.4666666666666667, 'recall': 0.3684210526315789, 'f1': 0.4117647058823529}
has_upperparts_color_white: {'accuracy': 0.8425925925925926, 'precision': 0.7777777777777778, 'recall': 0.3181818181818182, 'f1': 0.45161290322580644}
has_upperparts_color_buff: {'accuracy': 0.9537037037037037, 'precision': 0.5, 'recall': 0.6, 'f1': 0.5454545454545454}
has_underparts_color_brown: {'accuracy': 0.8888888888888888, 'precision': 0.75, 'recall': 0.21428571428571427, 'f1': 0.3333333333333333}
has_underparts_color_grey: {'accuracy': 0.8148148148148148, 'precision': 0.5555555555555556, 'recall': 0.23809523809523808, 'f1': 0.3333333333333333}
has_underparts_color_yellow: {'accuracy': 0.9722222222222222, 'precision': 0.9583333333333334, 'recall': 0.92, 'f1': 0.9387755102040817}
has_underparts_color_black: {'accuracy': 0.9444444444444444, 'precision': 0.875, 'recall': 0.875, 'f1': 0.875}
has_underparts_color_white: {'accuracy': 0.9537037037037037, 'precision': 0.9166666666666666, 'recall': 0.88, 'f1': 0.8979591836734694}
has_underparts_color_buff: {'accuracy': 0.9166666666666666, 'precision': 0.9090909090909091, 'recall': 0.7407407407407407, 'f1': 0.8163265306122449}
has_breast_pattern_solid: {'accuracy': 0.9074074074074074, 'precision': 0.9545454545454546, 'recall': 0.7, 'f1': 0.8076923076923077}
has_breast_pattern_striped: {'accuracy': 0.9814814814814815, 'precision': 1.0, 'recall': 0.9166666666666666, 'f1': 0.9565217391304348}
has_breast_pattern_multicolored: {'accuracy': 0.9259259259259259, 'precision': 1.0, 'recall': 0.6363636363636364, 'f1': 0.7777777777777778}
has_back_color_brown: {'accuracy': 0.7870370370370371, 'precision': 0.47368421052631576, 'recall': 0.4090909090909091, 'f1': 0.43902439024390244}
has_back_color_grey: {'accuracy': 0.9444444444444444, 'precision': 0.8666666666666667, 'recall': 0.7647058823529411, 'f1': 0.8125}
has_back_color_yellow: {'accuracy': 0.9351851851851852, 'precision': 0.8888888888888888, 'recall': 0.7619047619047619, 'f1': 0.8205128205128205}
has_back_color_black: {'accuracy': 0.7685185185185185, 'precision': 0.8888888888888888, 'recall': 0.25, 'f1': 0.3902439024390244}
has_back_color_white: {'accuracy': 0.7962962962962963, 'precision': 0.35294117647058826, 'recall': 0.35294117647058826, 'f1': 0.35294117647058826}
has_back_color_buff: {'accuracy': 0.7592592592592593, 'precision': 0.4117647058823529, 'recall': 0.30434782608695654, 'f1': 0.35}
has_tail_shape_notched_tail: {'accuracy': 0.8981481481481481, 'precision': 0.9166666666666666, 'recall': 0.5238095238095238, 'f1': 0.6666666666666666}
has_upper_tail_color_brown: {'accuracy': 0.8611111111111112, 'precision': 0.9285714285714286, 'recall': 0.48148148148148145, 'f1': 0.6341463414634146}
has_upper_tail_color_grey: {'accuracy': 0.8518518518518519, 'precision': 0.7777777777777778, 'recall': 0.5384615384615384, 'f1': 0.6363636363636364}
has_upper_tail_color_black: {'accuracy': 0.9259259259259259, 'precision': 1.0, 'recall': 0.6521739130434783, 'f1': 0.7894736842105263}
has_upper_tail_color_white: {'accuracy': 0.7962962962962963, 'precision': 0.7692307692307693, 'recall': 0.3448275862068966, 'f1': 0.47619047619047616}
has_upper_tail_color_buff: {'accuracy': 0.8796296296296297, 'precision': 0.38461538461538464, 'recall': 0.5, 'f1': 0.43478260869565216}
has_head_pattern_plain: {'accuracy': 0.9444444444444444, 'precision': 0.16666666666666666, 'recall': 0.5, 'f1': 0.25}
has_head_pattern_capped: {'accuracy': 0.7870370370370371, 'precision': 0.16666666666666666, 'recall': 0.13333333333333333, 'f1': 0.14814814814814814}
has_breast_color_brown: {'accuracy': 0.8703703703703703, 'precision': 0.6, 'recall': 0.375, 'f1': 0.46153846153846156}
has_breast_color_grey: {'accuracy': 0.7870370370370371, 'precision': 0.5, 'recall': 0.21739130434782608, 'f1': 0.30303030303030304}
has_breast_color_yellow: {'accuracy': 0.9351851851851852, 'precision': 0.2222222222222222, 'recall': 1.0, 'f1': 0.36363636363636365}
has_breast_color_black: {'accuracy': 0.9814814814814815, 'precision': 0.9615384615384616, 'recall': 0.9615384615384616, 'f1': 0.9615384615384616}
has_breast_color_white: {'accuracy': 0.9351851851851852, 'precision': 0.875, 'recall': 0.84, 'f1': 0.8571428571428571}
has_breast_color_buff: {'accuracy': 0.8703703703703703, 'precision': 0.6666666666666666, 'recall': 0.7272727272727273, 'f1': 0.6956521739130435}
has_throat_color_grey: {'accuracy': 0.9722222222222222, 'precision': 0.96, 'recall': 0.9230769230769231, 'f1': 0.9411764705882353}
has_throat_color_yellow: {'accuracy': 0.9444444444444444, 'precision': 0.88, 'recall': 0.88, 'f1': 0.88}
has_throat_color_black: {'accuracy': 0.9629629629629629, 'precision': 0.92, 'recall': 0.92, 'f1': 0.92}
has_throat_color_white: {'accuracy': 0.9259259259259259, 'precision': 0.9166666666666666, 'recall': 0.7857142857142857, 'f1': 0.8461538461538461}
has_eye_color_black: {'accuracy': 0.9537037037037037, 'precision': 0.96, 'recall': 0.8571428571428571, 'f1': 0.9056603773584906}
has_bill_length_about_the_same_as_head: {'accuracy': 0.9074074074074074, 'precision': 0.8636363636363636, 'recall': 0.7307692307692307, 'f1': 0.7916666666666666}
has_bill_length_shorter_than_head: {'accuracy': 0.9537037037037037, 'precision': 0.88, 'recall': 0.9166666666666666, 'f1': 0.8979591836734694}
has_forehead_color_blue: {'accuracy': 0.9351851851851852, 'precision': 0.9565217391304348, 'recall': 0.7857142857142857, 'f1': 0.8627450980392157}
has_forehead_color_brown: {'accuracy': 0.7129629629629629, 'precision': 0.3333333333333333, 'recall': 0.34782608695652173, 'f1': 0.3404255319148936}
has_forehead_color_grey: {'accuracy': 0.8981481481481481, 'precision': 0.7307692307692307, 'recall': 0.8260869565217391, 'f1': 0.7755102040816326}
has_forehead_color_yellow: {'accuracy': 0.7037037037037037, 'precision': 0.4444444444444444, 'recall': 0.26666666666666666, 'f1': 0.3333333333333333}
has_forehead_color_black: {'accuracy': 0.9814814814814815, 'precision': 0.9615384615384616, 'recall': 0.9615384615384616, 'f1': 0.9615384615384616}
has_forehead_color_white: {'accuracy': 0.8055555555555556, 'precision': 0.9411764705882353, 'recall': 0.4444444444444444, 'f1': 0.6037735849056604}
has_forehead_color_red: {'accuracy': 0.7870370370370371, 'precision': 0.21052631578947367, 'recall': 0.3333333333333333, 'f1': 0.25806451612903225}
has_under_tail_color_brown: {'accuracy': 0.8055555555555556, 'precision': 0.5, 'recall': 0.19047619047619047, 'f1': 0.27586206896551724}
has_under_tail_color_grey: {'accuracy': 0.8148148148148148, 'precision': 0.6363636363636364, 'recall': 0.5384615384615384, 'f1': 0.5833333333333334}
has_under_tail_color_yellow: {'accuracy': 0.8148148148148148, 'precision': 0.7647058823529411, 'recall': 0.4482758620689655, 'f1': 0.5652173913043478}
has_under_tail_color_black: {'accuracy': 0.7962962962962963, 'precision': 0.75, 'recall': 0.32142857142857145, 'f1': 0.45}
has_under_tail_color_white: {'accuracy': 0.8518518518518519, 'precision': 0.6818181818181818, 'recall': 0.625, 'f1': 0.6521739130434783}
has_under_tail_color_buff: {'accuracy': 0.9074074074074074, 'precision': 0.7727272727272727, 'recall': 0.7727272727272727, 'f1': 0.7727272727272727}
has_nape_color_blue: {'accuracy': 0.8240740740740741, 'precision': 0.8, 'recall': 0.5161290322580645, 'f1': 0.6274509803921569}
has_nape_color_brown: {'accuracy': 0.75, 'precision': 0.8181818181818182, 'recall': 0.43902439024390244, 'f1': 0.5714285714285714}
has_nape_color_grey: {'accuracy': 0.8425925925925926, 'precision': 0.7619047619047619, 'recall': 0.5714285714285714, 'f1': 0.6530612244897959}
has_nape_color_yellow: {'accuracy': 0.8518518518518519, 'precision': 0.6666666666666666, 'recall': 0.6086956521739131, 'f1': 0.6363636363636364}
has_nape_color_black: {'accuracy': 0.8148148148148148, 'precision': 0.20833333333333334, 'recall': 0.8333333333333334, 'f1': 0.3333333333333333}
has_nape_color_white: {'accuracy': 0.8888888888888888, 'precision': 0.9, 'recall': 0.6428571428571429, 'f1': 0.75}
has_nape_color_buff: {'accuracy': 0.8981481481481481, 'precision': 0.8571428571428571, 'recall': 0.6923076923076923, 'f1': 0.7659574468085106}
has_belly_color_grey: {'accuracy': 0.9259259259259259, 'precision': 1.0, 'recall': 0.5555555555555556, 'f1': 0.7142857142857143}
has_belly_color_yellow: {'accuracy': 0.8796296296296297, 'precision': 0.8, 'recall': 0.42105263157894735, 'f1': 0.5517241379310345}
has_belly_color_black: {'accuracy': 0.8518518518518519, 'precision': 1.0, 'recall': 0.23809523809523808, 'f1': 0.38461538461538464}
has_belly_color_white: {'accuracy': 0.8981481481481481, 'precision': 0.7, 'recall': 0.4666666666666667, 'f1': 0.56}
has_belly_color_buff: {'accuracy': 0.9351851851851852, 'precision': 1.0, 'recall': 0.5882352941176471, 'f1': 0.7407407407407407}
has_wing_shape_roundedwings: {'accuracy': 0.9074074074074074, 'precision': 0.8181818181818182, 'recall': 0.5294117647058824, 'f1': 0.6428571428571429}
has_size_small_5__9_in: {'accuracy': 0.7777777777777778, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0}
has_size_medium_9__16_in: {'accuracy': 0.7777777777777778, 'precision': 0.6666666666666666, 'recall': 0.2222222222222222, 'f1': 0.3333333333333333}
has_size_very_small_3__5_in: {'accuracy': 0.7962962962962963, 'precision': 0.375, 'recall': 0.15, 'f1': 0.21428571428571427}
has_shape_perchinglike: {'accuracy': 0.7685185185185185, 'precision': 0.9090909090909091, 'recall': 0.29411764705882354, 'f1': 0.4444444444444444}
has_back_pattern_solid: {'accuracy': 0.8333333333333334, 'precision': 0.6, 'recall': 0.3, 'f1': 0.4}
has_back_pattern_striped: {'accuracy': 0.8425925925925926, 'precision': 0.75, 'recall': 0.391304347826087, 'f1': 0.5142857142857142}
has_back_pattern_multicolored: {'accuracy': 0.8981481481481481, 'precision': 0.8, 'recall': 0.47058823529411764, 'f1': 0.5925925925925926}
has_tail_pattern_solid: {'accuracy': 0.8148148148148148, 'precision': 0.09090909090909091, 'recall': 0.09090909090909091, 'f1': 0.09090909090909091}
has_tail_pattern_multicolored: {'accuracy': 0.9444444444444444, 'precision': 1.0, 'recall': 0.6842105263157895, 'f1': 0.8125}
has_belly_pattern_solid: {'accuracy': 0.8148148148148148, 'precision': 0.1, 'recall': 0.08333333333333333, 'f1': 0.09090909090909091}
has_primary_color_brown: {'accuracy': 0.8796296296296297, 'precision': 0.8181818181818182, 'recall': 0.45, 'f1': 0.5806451612903226}
has_primary_color_grey: {'accuracy': 0.8888888888888888, 'precision': 0.7272727272727273, 'recall': 0.47058823529411764, 'f1': 0.5714285714285714}
has_primary_color_yellow: {'accuracy': 0.8611111111111112, 'precision': 0.7, 'recall': 0.3684210526315789, 'f1': 0.4827586206896552}
has_primary_color_black: {'accuracy': 0.7962962962962963, 'precision': 0.7142857142857143, 'recall': 0.2, 'f1': 0.3125}
has_primary_color_white: {'accuracy': 0.9351851851851852, 'precision': 0.7777777777777778, 'recall': 0.5833333333333334, 'f1': 0.6666666666666666}
has_primary_color_buff: {'accuracy': 0.75, 'precision': 0.25, 'recall': 0.08695652173913043, 'f1': 0.12903225806451613}
has_leg_color_grey: {'accuracy': 0.7962962962962963, 'precision': 0.375, 'recall': 0.15, 'f1': 0.21428571428571427}
has_leg_color_black: {'accuracy': 0.9444444444444444, 'precision': 0.8888888888888888, 'recall': 0.6153846153846154, 'f1': 0.7272727272727273}
has_leg_color_buff: {'accuracy': 0.8055555555555556, 'precision': 1.0, 'recall': 0.125, 'f1': 0.2222222222222222}
has_bill_color_grey: {'accuracy': 0.8425925925925926, 'precision': 1.0, 'recall': 0.19047619047619047, 'f1': 0.32}
has_bill_color_black: {'accuracy': 0.8888888888888888, 'precision': 0.5, 'recall': 0.16666666666666666, 'f1': 0.25}
has_crown_color_blue: {'accuracy': 0.7962962962962963, 'precision': 1.0, 'recall': 0.08333333333333333, 'f1': 0.15384615384615385}
has_crown_color_brown: {'accuracy': 0.8981481481481481, 'precision': 0.8695652173913043, 'recall': 0.7142857142857143, 'f1': 0.7843137254901961}
has_crown_color_grey: {'accuracy': 0.8888888888888888, 'precision': 0.88, 'recall': 0.7096774193548387, 'f1': 0.7857142857142857}
has_crown_color_yellow: {'accuracy': 0.7962962962962963, 'precision': 0.6363636363636364, 'recall': 0.5, 'f1': 0.56}
has_crown_color_black: {'accuracy': 0.8703703703703703, 'precision': 0.7619047619047619, 'recall': 0.64, 'f1': 0.6956521739130435}
has_crown_color_white: {'accuracy': 0.9166666666666666, 'precision': 0.8695652173913043, 'recall': 0.7692307692307693, 'f1': 0.8163265306122449}
has_wing_pattern_solid: {'accuracy': 0.9351851851851852, 'precision': 0.88, 'recall': 0.8461538461538461, 'f1': 0.8627450980392157}
has_wing_pattern_striped: {'accuracy': 0.8888888888888888, 'precision': 0.8333333333333334, 'recall': 0.5, 'f1': 0.625}
has_wing_pattern_multicolored: {'accuracy': 0.9074074074074074, 'precision': 0.9166666666666666, 'recall': 0.55, 'f1': 0.6875}
Overall Accuracy: 0.827024827024827
<<< Model Test Results: AUROC >>>
MEAN : 0.8146
has_bill_shape_dagger : 0.8297
has_bill_shape_hooked_seabird : 0.9572
has_bill_shape_allpurpose : 0.7906
has_bill_shape_cone : 0.8471
has_wing_color_brown : 0.8315
has_wing_color_grey : 0.7516
has_wing_color_yellow : 0.9026
has_wing_color_black : 0.7421
has_wing_color_white : 0.7979
has_wing_color_buff : 0.8238
has_upperparts_color_brown : 0.8391
has_upperparts_color_grey : 0.7501
has_upperparts_color_yellow : 0.9268
has_upperparts_color_black : 0.7410
has_upperparts_color_white : 0.7956
has_upperparts_color_buff : 0.8246
has_underparts_color_brown : 0.8278
has_underparts_color_grey : 0.7577
has_underparts_color_yellow : 0.9598
has_underparts_color_black : 0.8438
has_underparts_color_white : 0.8656
has_underparts_color_buff : 0.8284
has_breast_pattern_solid : 0.7871
has_breast_pattern_striped : 0.8256
has_breast_pattern_multicolored : 0.7141
has_back_color_brown : 0.8423
has_back_color_grey : 0.7338
has_back_color_yellow : 0.9228
has_back_color_black : 0.8161
has_back_color_white : 0.8185
has_back_color_buff : 0.8341
has_tail_shape_notched_tail : 0.6444
has_upper_tail_color_brown : 0.8022
has_upper_tail_color_grey : 0.7000
has_upper_tail_color_black : 0.7602
has_upper_tail_color_white : 0.8022
has_upper_tail_color_buff : 0.8104
has_head_pattern_plain : 0.8002
has_head_pattern_capped : 0.7332
has_breast_color_brown : 0.8599
has_breast_color_grey : 0.7498
has_breast_color_yellow : 0.9620
has_breast_color_black : 0.8810
has_breast_color_white : 0.8597
has_breast_color_buff : 0.8332
has_throat_color_grey : 0.7770
has_throat_color_yellow : 0.9617
has_throat_color_black : 0.8802
has_throat_color_white : 0.8854
has_eye_color_black : 0.6742
has_bill_length_about_the_same_as_head : 0.7940
has_bill_length_shorter_than_head : 0.8380
has_forehead_color_blue : 0.9555
has_forehead_color_brown : 0.8639
has_forehead_color_grey : 0.7869
has_forehead_color_yellow : 0.9569
has_forehead_color_black : 0.8220
has_forehead_color_white : 0.8717
has_forehead_color_red : 0.9445
has_under_tail_color_brown : 0.7955
has_under_tail_color_grey : 0.6751
has_under_tail_color_yellow : 0.9064
has_under_tail_color_black : 0.7366
has_under_tail_color_white : 0.7784
has_under_tail_color_buff : 0.7642
has_nape_color_blue : 0.9215
has_nape_color_brown : 0.8534
has_nape_color_grey : 0.7898
has_nape_color_yellow : 0.9376
has_nape_color_black : 0.8446
has_nape_color_white : 0.8516
has_nape_color_buff : 0.8515
has_belly_color_grey : 0.7625
has_belly_color_yellow : 0.9698
has_belly_color_black : 0.8902
has_belly_color_white : 0.8553
has_belly_color_buff : 0.8185
has_wing_shape_roundedwings : 0.5747
has_size_small_5__9_in : 0.7084
has_size_medium_9__16_in : 0.8811
has_size_very_small_3__5_in : 0.7488
has_shape_perchinglike : 0.8153
has_back_pattern_solid : 0.7340
has_back_pattern_striped : 0.7728
has_back_pattern_multicolored : 0.6197
has_tail_pattern_solid : 0.6608
has_tail_pattern_multicolored : 0.6535
has_belly_pattern_solid : 0.7777
has_primary_color_brown : 0.8609
has_primary_color_grey : 0.7610
has_primary_color_yellow : 0.9608
has_primary_color_black : 0.8029
has_primary_color_white : 0.8302
has_primary_color_buff : 0.8360
has_leg_color_grey : 0.7235
has_leg_color_black : 0.8045
has_leg_color_buff : 0.7933
has_bill_color_grey : 0.6779
has_bill_color_black : 0.7726
has_crown_color_blue : 0.9279
has_crown_color_brown : 0.8635
has_crown_color_grey : 0.7921
has_crown_color_yellow : 0.9328
has_crown_color_black : 0.8297
has_crown_color_white : 0.8770
has_wing_pattern_solid : 0.7806
has_wing_pattern_striped : 0.7508
has_wing_pattern_multicolored : 0.7154
------------------------
Classification report is saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/stats/cls_report.pkl
AUC-ROC report is saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/stats/AUC_ROC.pkl
../../shared_data/group12/og_attr_checkpoints/cub/t/lr_0.001_epochs_95/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE
./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/stats
./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g
Saving spurious concepts for training set
Saving concepts for training set
Saved logits concepts_x size: torch.Size([9422, 108])
Saved proba concepts_x size: torch.Size([9422, 108])
Saved class_labels size: torch.Size([9422])
Saved attributes size: torch.Size([9422, 108])
Saved image_tensor size: torch.Size([9422, 3, 448, 448])
Logits Concepts saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/train_logits_concepts.pt
Proba Concepts saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/train_proba_concepts.pt
Class labels saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/train_class_labels.pt
Attributes labels saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/train_attributes.pt
Image_tensor saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/train_image_tensor.pt
Saving concepts for val set
Saved logits concepts_x size: torch.Size([1183, 108])
Saved proba concepts_x size: torch.Size([1183, 108])
Saved class_labels size: torch.Size([1183])
Saved attributes size: torch.Size([1183, 108])
Saved image_tensor size: torch.Size([1183, 3, 448, 448])
Logits Concepts saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/val_logits_concepts.pt
Proba Concepts saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/val_proba_concepts.pt
Class labels saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/val_class_labels.pt
Attributes labels saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/val_attributes.pt
Image_tensor saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/val_image_tensor.pt
Saving concepts for test set
Saved logits concepts_x size: torch.Size([1183, 108])
Saved proba concepts_x size: torch.Size([1183, 108])
Saved class_labels size: torch.Size([1183])
Saved attributes size: torch.Size([1183, 108])
Saved image_tensor size: torch.Size([1183, 3, 448, 448])
Logits Concepts saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/test_logits_concepts.pt
Proba Concepts saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/test_proba_concepts.pt
Class labels saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/test_class_labels.pt
Attributes labels saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/test_attributes.pt
Image_tensor saved at ./out/cub/t/lr_0.001_epochs_95_ResNet101_layer4_adaptive_sgd_BCE/dataset_g/test_image_tensor.pt
